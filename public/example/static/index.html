
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1" />
        <meta name="description" content="goserv - A lightweight toolkit for web applications in Go" />
        <meta name="author" content="Marcel Gotsch" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta name="keywords" content="goserv, go, golang, framework, static, file server" />

        <meta name="og:title" content="goserv - File Server" />

        <title>goserv - File Server</title>


        <link rel="canonical" href="http://goserv.it/example/static/" />
        <link href="" rel="alternate" type="application/rss+xml" title="goserv - A lightweight toolkit for web applications in Go" />
        <link rel="shortcut icon" href="http://goserv.it/images/favicon.png" type="image/png" />

        <link href="//fonts.googleapis.com/css?family=Lily+Script+One|Droid+Sans:400,700|Droid+Serif|Inconsolata:400,700" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
        <link rel="stylesheet" href="http://goserv.it/css/theme.css" />
    </head>
    <body>
    <header id="gs-header">
    <input type="checkbox" id="gs-mobile-nav-cb" />
    <div class="flex centered-content">
        <div class="flex flex-col flex-vcenter flex-hstart">
            <div id="gs-header-name"><a href="http://goserv.it">goserv</a></div>
            <div id="gs-header-desc" class="s-hide">A lightweight toolkit for web applications in Go</div>
        </div>
        <div class="flex flex-row flex-vcenter flex-hcenter flex-grow">
            <div id="gs-header-logo"></div>
        </div>
        <div class="flex flex-row flex-vcenter flex-hend">
            <nav id="gs-header-nav" class="l-hide">
                
                
                    
                    <a href="http://goserv.it/news/"  class="gs-nav-entry" >News</a>
                    
                
                    
                    <span  class="gs-nav-entry gs-sub-nav active" >
                        <div class="gs-sub-nav-name">Getting Started</div>
                        <div class="triangle-fill"><div class="triangle-up"></div></div>
                        <div class="gs-sub-nav-content">
                            
                            <a href="http://goserv.it/example/routing/"  class="gs-sub-nav-entry" >Routing</a>
                            
                            <a href="http://goserv.it/example/context/"  class="gs-sub-nav-entry" >Request Context</a>
                            
                            <a href="http://goserv.it/example/errors/"  class="gs-sub-nav-entry" >Error Handling</a>
                            
                            <a href="http://goserv.it/example/json/"  class="gs-sub-nav-entry" >JSON Support</a>
                            
                            <a href="http://goserv.it/example/static/"  class="gs-sub-nav-entry active" >File Server</a>
                            
                            <a href="http://goserv.it/example/rest/"  class="gs-sub-nav-entry" >REST &amp; MongoDB</a>
                            
                        </div>
                    </span>
                    
                
                    
                    <span  class="gs-nav-entry gs-sub-nav" >
                        <div class="gs-sub-nav-name">Documentation</div>
                        <div class="triangle-fill"><div class="triangle-up"></div></div>
                        <div class="gs-sub-nav-content">
                            
                            <a href="https://godoc.org/github.com/gotschmarcel/goserv"  class="gs-sub-nav-entry" >API Reference</a>
                            
                        </div>
                    </span>
                    
                
            </nav>
            <label for="gs-mobile-nav-cb" id="gs-mobile-nav-toggle" class="fa fa-bars l-show"></label>
        </div>
    </div>
    <div class="s-show" id="gs-header-mobile-desc">A lightweight toolkit for web applications in Go</div>
    <div id="gs-mobile-nav" class="l-show">
        
        
            
            <a href="http://goserv.it/news/" class="gs-mobile-nav-entry">News</a>
            
        
            
            <div class="gs-mobile-nav-entry gs-mobile-sub-nav">
                <label for="gs-mobile-sub-nav-cb-getting_started">Getting Started</label>
                <input type="checkbox" id="gs-mobile-sub-nav-cb-getting_started" />
                <div class="gs-mobile-sub-nav-content">
                    
                    <a href="http://goserv.it/example/routing/" class="gs-mobile-sub-nav-entry">Routing</a>
                    
                    <a href="http://goserv.it/example/context/" class="gs-mobile-sub-nav-entry">Request Context</a>
                    
                    <a href="http://goserv.it/example/errors/" class="gs-mobile-sub-nav-entry">Error Handling</a>
                    
                    <a href="http://goserv.it/example/json/" class="gs-mobile-sub-nav-entry">JSON Support</a>
                    
                    <a href="http://goserv.it/example/static/" class="gs-mobile-sub-nav-entry">File Server</a>
                    
                    <a href="http://goserv.it/example/rest/" class="gs-mobile-sub-nav-entry">REST &amp; MongoDB</a>
                    
                </div>
            </div>
            
        
            
            <div class="gs-mobile-nav-entry gs-mobile-sub-nav">
                <label for="gs-mobile-sub-nav-cb-documentation">Documentation</label>
                <input type="checkbox" id="gs-mobile-sub-nav-cb-documentation" />
                <div class="gs-mobile-sub-nav-content">
                    
                    <a href="https://godoc.org/github.com/gotschmarcel/goserv" class="gs-mobile-sub-nav-entry">API Reference</a>
                    
                </div>
            </div>
            
        
    </div>
</header>



<article id="gs-article" class="centered-content-small">
    <h1 class="title">File Server</h1>
    <div class="content">
    <p>Often it is necessary to serve static content along with dynamic content. Fortunately, the standard library already
provides a simple function to create a <a href="https://golang.org/pkg/net/http/#FileServer">file server</a>.
Due to the compatibility of <em>goserv</em> to the standard library you can use it as is:</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">import</span> <span style="color: #000000; font-weight: bold">(</span>
    <span style="color: #4e9a06">&quot;log&quot;</span>
    <span style="color: #4e9a06">&quot;net/http&quot;</span>
    <span style="color: #4e9a06">&quot;github.com/gotschmarcel/goserv&quot;</span>
<span style="color: #000000; font-weight: bold">)</span>

<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000">main</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">server</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">NewServer</span><span style="color: #000000; font-weight: bold">()</span>

    <span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">UseHandler</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">FileServer</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Dir</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/usr/share/doc&quot;</span><span style="color: #000000; font-weight: bold">)))</span>

    <span style="color: #000000">log</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Fatalln</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Listen</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;:12345&quot;</span><span style="color: #000000; font-weight: bold">))</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>


<p>To serve files under a certain prefix we need to strip the prefix from the request path before
passing it to the file server. Luckily the standard library provides a helper for that also:</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">import</span> <span style="color: #000000; font-weight: bold">(</span>
    <span style="color: #4e9a06">&quot;log&quot;</span>
    <span style="color: #4e9a06">&quot;net/http&quot;</span>
    <span style="color: #4e9a06">&quot;github.com/gotschmarcel/goserv&quot;</span>
<span style="color: #000000; font-weight: bold">)</span>
<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000">main</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">server</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">NewServer</span><span style="color: #000000; font-weight: bold">()</span>

    <span style="color: #000000">fileServer</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">FileServer</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Dir</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/usr/share/doc&quot;</span><span style="color: #000000; font-weight: bold">))</span>
    <span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">SubRouter</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/public&quot;</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">UseHandler</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StripPrefix</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/public/&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">fileServer</span><span style="color: #000000; font-weight: bold">))</span>

    <span style="color: #000000">log</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Fatalln</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Listen</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;:12345&quot;</span><span style="color: #000000; font-weight: bold">))</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>
</p>

    </div>
</article>

        <footer id="gs-footer">
            <div id="gs-footer-content" class="centered-content">
                <div id="gs-footer-logo" class="m-hide"></div>
                <div id="gs-footer-info-left">
                    <div id="gs-footer-name">goserv</div>
                    <div id="gs-footer-desc">A lightweight toolkit for web applications in Go</div>
                </div>
                <div class="flex-grow"></div>
                <div id="gs-footer-info-right">
                    
                    <div class="gs-footer-info-entry"><a href="//github.com/gotschmarcel/goserv" target="_blank"><i class="fa fa-github left-of"></i>GitHub</a></div>
                    
                    
                    <div class="gs-footer-info-entry"><i class="fa fa-envelope left-of"></i><span>hello@goserv.it</span></div>
                    
                    
                    <div class="gs-footer-info-entry"><a href="https://twitter.com/gotschmarcel" target="_blank"><i class="fa fa-twitter left-of"></i>@gotschmarcel</a></div>
                    
                    
                </div>
            </div>
            <div id="gs-footer-copy">&copy; 2016 Marcel Gotsch</div>
        </footer>

        
        <script type="text/javascript">
          var _paq = _paq || [];
          _paq.push(['trackPageView']);
          _paq.push(['enableLinkTracking']);
          (function() {
            var u="//piwik.gts.octans.uberspace.de/";
            _paq.push(['setTrackerUrl', u+'piwik.php']);
            _paq.push(['setSiteId', 1]);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
          })();
        </script>
        <noscript><p><img src="//piwik.gts.octans.uberspace.de/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
        
    </body>
</html>


