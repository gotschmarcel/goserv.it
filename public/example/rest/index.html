
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1" />
        <meta name="description" content="goserv - A lightweight toolkit for web applications in Go" />
        <meta name="author" content="Marcel Gotsch" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta name="keywords" content="goserv, go, golang, framework, rest, api" />

        <meta name="og:title" content="goserv - REST Server with MongoDB" />

        <title>goserv - REST Server with MongoDB</title>


        <link rel="canonical" href="http://goserv.it/example/rest/" />
        <link href="" rel="alternate" type="application/rss+xml" title="goserv - A lightweight toolkit for web applications in Go" />
        <link rel="shortcut icon" href="http://goserv.it/images/favicon.png" type="image/png" />

        <link href="//fonts.googleapis.com/css?family=Lily+Script+One|Droid+Sans:400,700|Droid+Serif|Inconsolata:400,700" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
        <link rel="stylesheet" href="http://goserv.it/css/theme.css" />
    </head>
    <body>
        <div id="gs-cookie-message" class="hidden">
            <div>
                We use cookies to track usage and preferences.
                <a href="http://goserv.it/cookies">Cookie policy</a>
            </div>
            <div id="gs-cookie-message-close">Close</div>
        </div>
        <header id="gs-header">
    <input type="checkbox" id="gs-mobile-nav-cb" />
    <div class="flex centered-content">
        <div class="flex flex-col flex-vcenter flex-hstart">
            <div id="gs-header-name"><a href="http://goserv.it">goserv</a></div>
            <div id="gs-header-desc" class="s-hide">A lightweight toolkit for web applications in Go</div>
        </div>
        <div class="flex flex-row flex-vcenter flex-hcenter flex-grow">
            <div id="gs-header-logo"></div>
        </div>
        <div class="flex flex-row flex-vcenter flex-hend">
            <nav id="gs-header-nav" class="l-hide">
                
                
                    
                    <a href="http://goserv.it/news/"  class="gs-nav-entry" >News</a>
                    
                
                    
                    <span  class="gs-nav-entry gs-sub-nav active" >
                        <div class="gs-sub-nav-name">Getting Started</div>
                        <div class="triangle-fill"><div class="triangle-up"></div></div>
                        <div class="gs-sub-nav-content">
                            
                            <a href="http://goserv.it/example/routing/"  class="gs-sub-nav-entry" >Routing</a>
                            
                            <a href="http://goserv.it/example/context/"  class="gs-sub-nav-entry" >Request Context</a>
                            
                            <a href="http://goserv.it/example/errors/"  class="gs-sub-nav-entry" >Error Handling</a>
                            
                            <a href="http://goserv.it/example/json/"  class="gs-sub-nav-entry" >JSON Support</a>
                            
                            <a href="http://goserv.it/example/static/"  class="gs-sub-nav-entry" >File Server</a>
                            
                            <a href="http://goserv.it/example/rest/"  class="gs-sub-nav-entry active" >REST &amp; MongoDB</a>
                            
                        </div>
                    </span>
                    
                
                    
                    <span  class="gs-nav-entry gs-sub-nav" >
                        <div class="gs-sub-nav-name">Documentation</div>
                        <div class="triangle-fill"><div class="triangle-up"></div></div>
                        <div class="gs-sub-nav-content">
                            
                            <a href="https://godoc.org/github.com/gotschmarcel/goserv"  class="gs-sub-nav-entry" >API Reference</a>
                            
                        </div>
                    </span>
                    
                
            </nav>
            <label for="gs-mobile-nav-cb" id="gs-mobile-nav-toggle" class="fa fa-bars l-show"></label>
        </div>
    </div>
    <div class="s-show" id="gs-header-mobile-desc">A lightweight toolkit for web applications in Go</div>
    <div id="gs-mobile-nav" class="l-show">
        
        
            
            <a href="http://goserv.it/news/" class="gs-mobile-nav-entry">News</a>
            
        
            
            <div class="gs-mobile-nav-entry gs-mobile-sub-nav">
                <label for="gs-mobile-sub-nav-cb-getting_started">Getting Started</label>
                <input type="checkbox" id="gs-mobile-sub-nav-cb-getting_started" />
                <div class="gs-mobile-sub-nav-content">
                    
                    <a href="http://goserv.it/example/routing/" class="gs-mobile-sub-nav-entry">Routing</a>
                    
                    <a href="http://goserv.it/example/context/" class="gs-mobile-sub-nav-entry">Request Context</a>
                    
                    <a href="http://goserv.it/example/errors/" class="gs-mobile-sub-nav-entry">Error Handling</a>
                    
                    <a href="http://goserv.it/example/json/" class="gs-mobile-sub-nav-entry">JSON Support</a>
                    
                    <a href="http://goserv.it/example/static/" class="gs-mobile-sub-nav-entry">File Server</a>
                    
                    <a href="http://goserv.it/example/rest/" class="gs-mobile-sub-nav-entry">REST &amp; MongoDB</a>
                    
                </div>
            </div>
            
        
            
            <div class="gs-mobile-nav-entry gs-mobile-sub-nav">
                <label for="gs-mobile-sub-nav-cb-documentation">Documentation</label>
                <input type="checkbox" id="gs-mobile-sub-nav-cb-documentation" />
                <div class="gs-mobile-sub-nav-content">
                    
                    <a href="https://godoc.org/github.com/gotschmarcel/goserv" class="gs-mobile-sub-nav-entry">API Reference</a>
                    
                </div>
            </div>
            
        
    </div>
</header>



<article id="gs-article" class="centered-content-small">
    <h1 class="title">REST Server with MongoDB</h1>
    <div class="content">
    <p>This example shows how a simple REST API server is build using <em>goserv</em> and <a href="https://labix.org/mgo"><em>mgo v2</em></a> (MongoDB).
The goal is to create a server to retrieve, create or delete todos by providing a REST API and using
MongoDB as storage backend.</p>

<blockquote>
<p>To keep it simple all code is included in the <strong>main.go</strong> file</p>
</blockquote>

<p>Let&rsquo;s start in the <code>main</code> function of our <strong>main.go</strong> and add the basic code to start a server:</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">package</span> <span style="color: #000000">main</span>

<span style="color: #204a87; font-weight: bold">import</span> <span style="color: #000000; font-weight: bold">(</span>
    <span style="color: #4e9a06">&quot;fmt&quot;</span>
    <span style="color: #4e9a06">&quot;log&quot;</span>
    <span style="color: #4e9a06">&quot;net/http&quot;</span>
    <span style="color: #4e9a06">&quot;gopkg.in/mgo.v2&quot;</span>
    <span style="color: #4e9a06">&quot;gopkg.in/mgo.v2/bson&quot;</span>
    <span style="color: #4e9a06">&quot;github.com/gotschmarcel/goserv&quot;</span>
<span style="color: #000000; font-weight: bold">)</span>

<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000">main</span><span style="color: #000000; font-weight: bold">()</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">server</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">NewServer</span><span style="color: #000000; font-weight: bold">()</span>

    <span style="color: #8f5902; font-style: italic">// ...</span>

    <span style="color: #000000">log</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Fatalln</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Listen</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;:12345&quot;</span><span style="color: #000000; font-weight: bold">))</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>


<p>Now we can start our server from the console with <code>$ go run main.go</code>. Next we need to define our
<code>Todo</code> type:</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">type</span> <span style="color: #000000">Todo</span> <span style="color: #204a87; font-weight: bold">struct</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">ID</span> <span style="color: #000000">bson</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ObjectId</span> <span style="color: #4e9a06">`json:&quot;id&quot; bson:&quot;_id,omitempty&quot;`</span>
    <span style="color: #000000">Title</span> <span style="color: #204a87; font-weight: bold">string</span> <span style="color: #4e9a06">`json:&quot;title&quot;`</span>
    <span style="color: #000000">Completed</span> <span style="color: #204a87; font-weight: bold">bool</span> <span style="color: #4e9a06">`json:&quot;completed&quot;`</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>


<blockquote>
<p>For more information about the json annotations take a look <a href="https://golang.org/pkg/encoding/json/">here</a></p>
</blockquote>

<p>The next thing we need is a controller providing handler functions for the API. Additionally the
controller needs a <code>mgo.Collection</code> which let&rsquo;s us interact with MongoDB.</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">type</span> <span style="color: #000000">Controller</span> <span style="color: #204a87; font-weight: bold">struct</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">todos</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">mgo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Collection</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>
</p>

<p>To get the collection we need to open a new <code>mgo.Session</code>. Using the session we can access the database
and its collection by name. Finally we create a controller and pass the collection to it:</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #000000">mongo</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">mgo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Dial</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;mongodb://localhost:27017&quot;</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">log</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Fatalln</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000; font-weight: bold">}</span>

<span style="color: #8f5902; font-style: italic">// Don&#39;t forget to cleanup the session</span>
<span style="color: #204a87; font-weight: bold">defer</span> <span style="color: #000000">mongo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Close</span><span style="color: #000000; font-weight: bold">()</span>

<span style="color: #8f5902; font-style: italic">// Create a new Controller with the &quot;todos&quot; collection</span>
<span style="color: #000000">controller</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">{</span><span style="color: #000000">mongo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">DB</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;goserv_rest&quot;</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">C</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todos&quot;</span><span style="color: #000000; font-weight: bold">)}</span>
</pre></div>
</p>

<p>Since we&rsquo;re now ready to interact with MongoDB it&rsquo;s time to write some route handlers for our
API. Let&rsquo;s start with the simplest one - requesting all todos from our database:</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">GetTodos</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">todos</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #204a87">make</span><span style="color: #000000; font-weight: bold">([]</span><span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Todo</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #0000cf; font-weight: bold">0</span><span style="color: #000000; font-weight: bold">)</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">c</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Find</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #204a87; font-weight: bold">nil</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">All</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteJSON</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000; font-weight: bold">}</span>

<span style="color: #000000; font-weight: bold">}</span>
</pre></div>
</p>

<p>Here makes it <em>goserv</em> easy for us by providing <code>WriteJSON</code> which automatically encodes the passed
values into JSON and sets the <em>Content-Type</em> to <code>application/json</code>. To retrieve only a single todo
by its ID we make use of URL parameters <code>/todos/:todo_id</code>. The parameter is extracted by goserv
and can be retrieved from the request context <code>Context(r).Param(&quot;todo_id&quot;)</code>:</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">GetTodo</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">ctx</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">hexID</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Param</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todo_id&quot;</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">objectID</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">bson</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ObjectIdHex</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">hexID</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">todo</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">Todo</span><span style="color: #000000; font-weight: bold">{}</span>

    <span style="color: #8f5902; font-style: italic">// Query the todo from MongoDB</span>
    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">c</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">FindId</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">objectID</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">One</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">todo</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">code</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span>

        <span style="color: #8f5902; font-style: italic">// Todo not found</span>
        <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">==</span> <span style="color: #000000">mgo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ErrNotFound</span> <span style="color: #000000; font-weight: bold">{</span>
            <span style="color: #000000">err</span> <span style="color: #000000; font-weight: bold">=</span> <span style="color: #000000">fmt</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Errorf</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;no such todo: %s&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">hexID</span><span style="color: #000000; font-weight: bold">)</span>
            <span style="color: #000000">code</span> <span style="color: #000000; font-weight: bold">=</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusNotFound</span>
        <span style="color: #000000; font-weight: bold">}</span>

        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">code</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #8f5902; font-style: italic">// Pass todo to next handler</span>
    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteJSON</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">todo</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>
</p>

<p>To make sure that we always get a valid ObjectID in our handlers we make use of goserv&rsquo;s parameter handlers.
The parameter handler gets invoked once before the handlers are processed.</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">TodoID</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">id</span> <span style="color: #204a87; font-weight: bold">string</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #8f5902; font-style: italic">// Validate that the URL parameter is a valid Object ID representation</span>
    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">bson</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">IsObjectIdHex</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">id</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">fmt</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Errorf</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;invalid id: %s&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">id</span><span style="color: #000000; font-weight: bold">),</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusBadRequest</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>
</p>

<p>Now we&rsquo;re able to query all of our todos or only a single todo. To create todos we must create
a <code>POST</code> handler. The todo to create is stored in the request body.</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">CreateTodo</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">ctx</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">todo</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">Todo</span><span style="color: #000000; font-weight: bold">{}</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ReadJSONBody</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">todo</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">fmt</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Errorf</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todo not well-formed&quot;</span><span style="color: #000000; font-weight: bold">),</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusBadRequest</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">c</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Insert</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">todo</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteHeader</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusCreated</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>
</p>

<p>The last handler allows us to delete existing todos:</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">DeleteTodo</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">ctx</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">hexID</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Param</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todo_id&quot;</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">objectID</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">bson</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ObjectIdHex</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">hexID</span><span style="color: #000000; font-weight: bold">)</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">c</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">RemoveId</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">objectID</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteHeader</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusNoContent</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>
</p>

<p>With our controller ready the only part left is to assign each handler function to a specific
route:</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Get</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/todos&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">GetTodos</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Post</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/todos&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">CreateTodo</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Get</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/todos/:todo_id&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">GetTodo</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Delete</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/todos/:todo_id&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">DeleteTodo</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Param</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todo_id&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">TodoID</span><span style="color: #000000; font-weight: bold">)</span>
</pre></div>
</p>

<p>Basically that&rsquo;s it for our REST server. Of course there&rsquo;s still room for improvement, so let&rsquo;s take
a look at some custom error handling to send every occurring error as JSON response. First we need
an error handler:</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">ErrorHandler</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ContextError</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteHeader</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Code</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteJSON</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #204a87; font-weight: bold">struct</span><span style="color: #000000; font-weight: bold">{</span> <span style="color: #000000">Error</span> <span style="color: #204a87; font-weight: bold">string</span> <span style="color: #4e9a06">`json:&quot;error&quot;`</span> <span style="color: #000000; font-weight: bold">}{</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">()});</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">log</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Printf</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;Error sending JSON: %s&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000; font-weight: bold">}</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>
</p>

<p>We can use a simple anonymous struct containing the error message to write the <code>err</code> as simple
JSON error response. The last step is to set the custom error handler on the server:</p>

<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ErrorHandler</span> <span style="color: #000000; font-weight: bold">=</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ErrorHandler</span>
</pre></div>
</p>

<div class="collapsable-codeblock">
<input type="checkbox" id="codeblock" />
<label for="codeblock">Full Example</label>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #204a87; font-weight: bold">package</span> <span style="color: #000000">main</span>

<span style="color: #204a87; font-weight: bold">import</span> <span style="color: #000000; font-weight: bold">(</span>
    <span style="color: #4e9a06">&quot;fmt&quot;</span>
    <span style="color: #4e9a06">&quot;log&quot;</span>
    <span style="color: #4e9a06">&quot;net/http&quot;</span>
    <span style="color: #4e9a06">&quot;gopkg.in/mgo.v2&quot;</span>
    <span style="color: #4e9a06">&quot;gopkg.in/mgo.v2/bson&quot;</span>
    <span style="color: #4e9a06">&quot;github.com/gotschmarcel/goserv&quot;</span>
<span style="color: #000000; font-weight: bold">)</span>

<span style="color: #204a87; font-weight: bold">type</span> <span style="color: #000000">Todo</span> <span style="color: #204a87; font-weight: bold">struct</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">ID</span> <span style="color: #000000">bson</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ObjectId</span> <span style="color: #4e9a06">`json:&quot;id&quot; bson:&quot;_id,omitempty&quot;`</span>
    <span style="color: #000000">Title</span> <span style="color: #204a87; font-weight: bold">string</span> <span style="color: #4e9a06">`json:&quot;title&quot;`</span>
    <span style="color: #000000">Completed</span> <span style="color: #204a87; font-weight: bold">bool</span> <span style="color: #4e9a06">`json:&quot;completed&quot;`</span>
<span style="color: #000000; font-weight: bold">}</span>

<span style="color: #204a87; font-weight: bold">type</span> <span style="color: #000000">Controller</span> <span style="color: #204a87; font-weight: bold">struct</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">todos</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">mgo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Collection</span>
<span style="color: #000000; font-weight: bold">}</span>

<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">GetTodos</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">todos</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #204a87">make</span><span style="color: #000000; font-weight: bold">([]</span><span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Todo</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #0000cf; font-weight: bold">0</span><span style="color: #000000; font-weight: bold">)</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">c</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Find</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #204a87; font-weight: bold">nil</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">All</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteJSON</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000; font-weight: bold">}</span>

<span style="color: #000000; font-weight: bold">}</span>

<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">GetTodo</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">ctx</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">hexID</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Param</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todo_id&quot;</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">objectID</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">bson</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ObjectIdHex</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">hexID</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">todo</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">Todo</span><span style="color: #000000; font-weight: bold">{}</span>

    <span style="color: #8f5902; font-style: italic">// Query the todo from MongoDB</span>
    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">c</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">FindId</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">objectID</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">One</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">todo</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">code</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span>

        <span style="color: #8f5902; font-style: italic">// Todo not found</span>
        <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">==</span> <span style="color: #000000">mgo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ErrNotFound</span> <span style="color: #000000; font-weight: bold">{</span>
            <span style="color: #000000">err</span> <span style="color: #000000; font-weight: bold">=</span> <span style="color: #000000">fmt</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Errorf</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;no such todo: %s&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">hexID</span><span style="color: #000000; font-weight: bold">)</span>
            <span style="color: #000000">code</span> <span style="color: #000000; font-weight: bold">=</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusNotFound</span>
        <span style="color: #000000; font-weight: bold">}</span>

        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">code</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #8f5902; font-style: italic">// Pass todo to next handler</span>
    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteJSON</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">todo</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>
<span style="color: #000000; font-weight: bold">}</span>

<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">TodoID</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">id</span> <span style="color: #204a87; font-weight: bold">string</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #8f5902; font-style: italic">// Validate that the URL parameter is a valid Object ID representation</span>
    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">bson</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">IsObjectIdHex</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">id</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">fmt</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Errorf</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;invalid id: %s&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">id</span><span style="color: #000000; font-weight: bold">),</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusBadRequest</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000; font-weight: bold">}</span>

<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">CreateTodo</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">ctx</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">todo</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">Todo</span><span style="color: #000000; font-weight: bold">{}</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ReadJSONBody</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">todo</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">fmt</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Errorf</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todo not well-formed&quot;</span><span style="color: #000000; font-weight: bold">),</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusBadRequest</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">c</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Insert</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">todo</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteHeader</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusCreated</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000; font-weight: bold">}</span>

<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">DeleteTodo</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">ctx</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Context</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">hexID</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Param</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todo_id&quot;</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">objectID</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">bson</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ObjectIdHex</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">hexID</span><span style="color: #000000; font-weight: bold">)</span>

    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">c</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">todos</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">RemoveId</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">objectID</span><span style="color: #000000; font-weight: bold">);</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">ctx</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusInternalServerError</span><span style="color: #000000; font-weight: bold">)</span>
        <span style="color: #204a87; font-weight: bold">return</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteHeader</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">StatusNoContent</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #000000; font-weight: bold">}</span>

<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">c</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000">ErrorHandler</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span> <span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ResponseWriter</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">http</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Request</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ContextError</span><span style="color: #000000; font-weight: bold">)</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteHeader</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Code</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">WriteJSON</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">w</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #204a87; font-weight: bold">struct</span><span style="color: #000000; font-weight: bold">{</span> <span style="color: #000000">Error</span> <span style="color: #204a87; font-weight: bold">string</span> <span style="color: #4e9a06">`json:&quot;error&quot;`</span> <span style="color: #000000; font-weight: bold">}{</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Error</span><span style="color: #000000; font-weight: bold">()});</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">log</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Printf</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;Error sending JSON: %s&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000; font-weight: bold">}</span>
<span style="color: #000000; font-weight: bold">}</span>

<span style="color: #204a87; font-weight: bold">func</span> <span style="color: #000000">main</span><span style="color: #000000; font-weight: bold">()</span> <span style="color: #000000; font-weight: bold">{</span>
    <span style="color: #000000">server</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">goserv</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">NewServer</span><span style="color: #000000; font-weight: bold">()</span>

    <span style="color: #000000">mongo</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #000000">mgo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Dial</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;mongodb://localhost:27017&quot;</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #204a87; font-weight: bold">if</span> <span style="color: #000000">err</span> <span style="color: #ce5c00; font-weight: bold">!=</span> <span style="color: #204a87; font-weight: bold">nil</span> <span style="color: #000000; font-weight: bold">{</span>
        <span style="color: #000000">log</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Fatalln</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">err</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000; font-weight: bold">}</span>

    <span style="color: #8f5902; font-style: italic">// Don&#39;t forget to cleanup the session</span>
    <span style="color: #204a87; font-weight: bold">defer</span> <span style="color: #000000">mongo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Close</span><span style="color: #000000; font-weight: bold">()</span>

    <span style="color: #8f5902; font-style: italic">// Create a new Controller with the &quot;todos&quot; collection</span>
    <span style="color: #000000">controller</span> <span style="color: #ce5c00; font-weight: bold">:=</span> <span style="color: #ce5c00; font-weight: bold">&amp;</span><span style="color: #000000">Controller</span><span style="color: #000000; font-weight: bold">{</span><span style="color: #000000">mongo</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">DB</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;goserv_rest&quot;</span><span style="color: #000000; font-weight: bold">).</span><span style="color: #000000">C</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todos&quot;</span><span style="color: #000000; font-weight: bold">)}</span>

    <span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Get</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/todos&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">GetTodos</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Post</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/todos&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">CreateTodo</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Get</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/todos/:todo_id&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">GetTodo</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Delete</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;/todos/:todo_id&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">DeleteTodo</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Param</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;todo_id&quot;</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">TodoID</span><span style="color: #000000; font-weight: bold">)</span>

    <span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ErrorHandler</span> <span style="color: #000000; font-weight: bold">=</span> <span style="color: #000000">controller</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">ErrorHandler</span>

    <span style="color: #000000">log</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Fatalln</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">server</span><span style="color: #000000; font-weight: bold">.</span><span style="color: #000000">Listen</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #4e9a06">&quot;:12345&quot;</span><span style="color: #000000; font-weight: bold">))</span>
<span style="color: #000000; font-weight: bold">}</span>
</pre></div>

</div>

    </div>
</article>

        <footer id="gs-footer">
            <div id="gs-footer-content" class="centered-content">
                <div id="gs-footer-logo" class="m-hide"></div>
                <div id="gs-footer-info-left">
                    <div id="gs-footer-name">goserv</div>
                    <div id="gs-footer-desc">A lightweight toolkit for web applications in Go</div>
                </div>
                <div class="flex-grow"></div>
                <div id="gs-footer-info-right">
                    
                    <div class="gs-footer-info-entry"><a href="//github.com/gotschmarcel/goserv" target="_blank"><i class="fa fa-github left-of"></i>GitHub</a></div>
                    
                    
                    <div class="gs-footer-info-entry"><i class="fa fa-envelope left-of"></i><span>hello@goserv.it</span></div>
                    
                    
                    <div class="gs-footer-info-entry"><a href="https://twitter.com/gotschmarcel" target="_blank"><i class="fa fa-twitter left-of"></i>@gotschmarcel</a></div>
                    
                    <div class="gs-footer-info-entry"><a href="http://goserv.it/cookies"><i class="fa fa-file-text left-of"></i>Cookie Policy</a></div>
                    
                </div>
            </div>
            <div id="gs-footer-copy">&copy; 2016 Marcel Gotsch</div>
        </footer>

        <script src="http://goserv.it/js/main.js"></script>

        
        <script type="text/javascript">
          var _paq = _paq || [];
          _paq.push(['trackPageView']);
          _paq.push(['enableLinkTracking']);
          (function() {
            var u="//piwik.gts.octans.uberspace.de/";
            _paq.push(['setTrackerUrl', u+'piwik.php']);
            _paq.push(['setSiteId', 1]);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
          })();
        </script>
        <noscript><p><img src="//piwik.gts.octans.uberspace.de/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
        
    </body>
</html>


